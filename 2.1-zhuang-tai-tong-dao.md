# 2.1 原型机：状态通道

假设 Alice 经常在一家咖啡店消费，如果每次买一杯 5 美元的咖啡，都需要支付 0.5 美元的手续费，这也太痛苦了。如果 Alice 和咖啡店能达成共识，每次买咖啡时付给咖啡店一张签了名的欠条，一段时间后咖啡店攒了足够多的欠条，将欠条算好总金额一次性兑现，这样交易成本就可以大幅降低。这种思路就是最早的二层网络，也就是状态通道的原理。

状态通道使用了多签技术，允许两个个体之间提前存入一笔资金锁定在智能合约中，建立一个内部通道，然后双方可以在通道内进行多笔小额转账，速度极快，成本极低，再在一段时间后用转账证明一次性提款。状态通道也是比特币的 Lightning Network （闪电网络），以太坊的 Raiden Network （雷电网络）背后的底层技术。

![【图：2.1.1 单通道雷电网络.gif】](https://www.notion.so/image/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F1e556aad-d303-4a00-9c75-e281e195fbdf%2FUntitled.png?id=c4904364-3f87-4651-9109-9044adc3b667\&table=block\&spaceId=b1dd17ad-aa83-4faf-9395-5329c519d830\&width=2000\&userId=e298088e-2c93-42ed-870b-b44d950d1eae\&cache=v2)

在雷电网络中，用户除了在通道内快速转账，还能借助多个节点的中转，向其他没有直接连接的账户发送资金。雷电网络节点越多，整个网络能处理交易的规模也将越大，实现有效扩容。

![【图：2.1.2 雷电网络.gif】](https://www.notion.so/image/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fa84415ef-393f-4864-8cda-ad1335778022%2FUntitled.png?id=19f1b366-e61a-4b10-a1c2-2226adace016\&table=block\&spaceId=b1dd17ad-aa83-4faf-9395-5329c519d830\&width=2000\&userId=e298088e-2c93-42ed-870b-b44d950d1eae\&cache=v2)

状态通道技术本质上是使用了**中心化的节点**，用户在链上质押一笔较大额的资金，然后在链下用签了名的“欠条”进行付款，积攒了一定量的“欠条”之后，任何一方都可以选择关闭通道进行结算。链上的智能合约只认可同时拥有双方签名的转账信息，Alice 和咖啡店都拥有自己的签名，再加上“欠条”上对方的签名才能**通过多签验证**，因此无法提取不属于自己的资金。

但这样做产生了 2 个新的问题：

1. Alice 和咖啡店之间攒“欠条”的约定仅适合于最简单的转账交易，去中心化金融要实现的交易比转账复杂得多，那么**想要实现更复杂的交易要怎么办呢**？为了解决这个问题，引出了**侧链**方案。
2. Alice 可以给咖啡店发送资金，若超市与咖啡店有通道，也可以借助咖啡店向超市发送资金，但是**如何给未参与雷电网络的个体发送资金呢**？这个问题，则引出了 **Plasma** 方案。
